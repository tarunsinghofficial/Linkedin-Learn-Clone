{"version":3,"sources":["HeaderSegment.tsx"],"names":["HeaderSegment","props","isParentHeaderShown","React","useContext","HeaderShownContext","leftLabelLayout","setLeftLabelLayout","useState","undefined","titleLayout","setTitleLayout","handleTitleLayout","e","height","width","nativeEvent","layout","handleLeftLabelLayout","getInterpolatedStyle","styleInterpolator","current","next","headerHeight","progress","layouts","header","screen","title","leftLabel","insets","modal","onGoBack","headerTitle","headerLeft","left","headerBackImage","headerBackTitle","headerBackTitleVisible","Platform","OS","headerTruncatedBackTitle","headerBackAccessibilityLabel","headerBackTestID","headerBackAllowFontScaling","headerBackTitleStyle","headerTitleContainerStyle","headerLeftContainerStyle","headerRightContainerStyle","headerBackgroundContainerStyle","headerStyle","customHeaderStyle","headerStatusBarHeight","top","rest","defaultHeight","StyleSheet","flatten","titleStyle","leftButtonStyle","leftLabelStyle","rightButtonStyle","backgroundStyle","backImage","accessibilityLabel","testID","allowFontScaling","onPress","label","truncatedLabel","labelStyle","onLabelLayout","screenLayout","canGoBack","Boolean","onLayout"],"mappings":"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","sourcesContent":["import {\n  getDefaultHeaderHeight,\n  Header,\n  HeaderBackButton,\n  HeaderBackButtonProps,\n  HeaderShownContext,\n  HeaderTitle,\n} from '@react-navigation/elements';\nimport * as React from 'react';\nimport {\n  Animated,\n  LayoutChangeEvent,\n  Platform,\n  StyleSheet,\n  ViewStyle,\n} from 'react-native';\nimport type { EdgeInsets } from 'react-native-safe-area-context';\n\nimport type {\n  Layout,\n  SceneProgress,\n  StackHeaderOptions,\n  StackHeaderStyleInterpolator,\n} from '../../types';\nimport memoize from '../../utils/memoize';\n\ntype Props = StackHeaderOptions & {\n  layout: Layout;\n  title: string;\n  insets: EdgeInsets;\n  modal: boolean;\n  onGoBack?: () => void;\n  progress: SceneProgress;\n  styleInterpolator: StackHeaderStyleInterpolator;\n};\n\nexport default function HeaderSegment(props: Props) {\n  const isParentHeaderShown = React.useContext(HeaderShownContext);\n\n  const [leftLabelLayout, setLeftLabelLayout] =\n    React.useState<Layout | undefined>(undefined);\n\n  const [titleLayout, setTitleLayout] =\n    React.useState<Layout | undefined>(undefined);\n\n  const handleTitleLayout = (e: LayoutChangeEvent) => {\n    const { height, width } = e.nativeEvent.layout;\n\n    setTitleLayout((titleLayout) => {\n      if (\n        titleLayout &&\n        height === titleLayout.height &&\n        width === titleLayout.width\n      ) {\n        return titleLayout;\n      }\n\n      return { height, width };\n    });\n  };\n\n  const handleLeftLabelLayout = (e: LayoutChangeEvent) => {\n    const { height, width } = e.nativeEvent.layout;\n\n    if (\n      leftLabelLayout &&\n      height === leftLabelLayout.height &&\n      width === leftLabelLayout.width\n    ) {\n      return;\n    }\n\n    setLeftLabelLayout({ height, width });\n  };\n\n  const getInterpolatedStyle = memoize(\n    (\n      styleInterpolator: StackHeaderStyleInterpolator,\n      layout: Layout,\n      current: Animated.AnimatedInterpolation,\n      next: Animated.AnimatedInterpolation | undefined,\n      titleLayout: Layout | undefined,\n      leftLabelLayout: Layout | undefined,\n      headerHeight: number\n    ) =>\n      styleInterpolator({\n        current: { progress: current },\n        next: next && { progress: next },\n        layouts: {\n          header: {\n            height: headerHeight,\n            width: layout.width,\n          },\n          screen: layout,\n          title: titleLayout,\n          leftLabel: leftLabelLayout,\n        },\n      })\n  );\n\n  const {\n    progress,\n    insets,\n    layout,\n    modal,\n    onGoBack,\n    headerTitle: title,\n    headerLeft: left = onGoBack\n      ? (props: HeaderBackButtonProps) => <HeaderBackButton {...props} />\n      : undefined,\n    headerBackImage,\n    headerBackTitle,\n    headerBackTitleVisible = Platform.OS === 'ios',\n    headerTruncatedBackTitle,\n    headerBackAccessibilityLabel,\n    headerBackTestID,\n    headerBackAllowFontScaling,\n    headerBackTitleStyle,\n    headerTitleContainerStyle,\n    headerLeftContainerStyle,\n    headerRightContainerStyle,\n    headerBackgroundContainerStyle,\n    headerStyle: customHeaderStyle,\n    headerStatusBarHeight = isParentHeaderShown ? 0 : insets.top,\n    styleInterpolator,\n    ...rest\n  } = props;\n\n  const defaultHeight = getDefaultHeaderHeight(\n    layout,\n    modal,\n    headerStatusBarHeight\n  );\n\n  const { height = defaultHeight } = StyleSheet.flatten(\n    customHeaderStyle || {}\n  ) as ViewStyle;\n\n  const {\n    titleStyle,\n    leftButtonStyle,\n    leftLabelStyle,\n    rightButtonStyle,\n    backgroundStyle,\n  } = getInterpolatedStyle(\n    styleInterpolator,\n    layout,\n    progress.current,\n    progress.next,\n    titleLayout,\n    headerBackTitle ? leftLabelLayout : undefined,\n    typeof height === 'number' ? height : defaultHeight\n  );\n\n  const headerLeft: StackHeaderOptions['headerLeft'] = left\n    ? (props) =>\n        left({\n          ...props,\n          backImage: headerBackImage,\n          accessibilityLabel: headerBackAccessibilityLabel,\n          testID: headerBackTestID,\n          allowFontScaling: headerBackAllowFontScaling,\n          onPress: onGoBack,\n          label: headerBackTitle,\n          truncatedLabel: headerTruncatedBackTitle,\n          labelStyle: [leftLabelStyle, headerBackTitleStyle],\n          onLabelLayout: handleLeftLabelLayout,\n          screenLayout: layout,\n          titleLayout,\n          canGoBack: Boolean(onGoBack),\n        })\n    : undefined;\n\n  const headerTitle: StackHeaderOptions['headerTitle'] =\n    typeof title !== 'function'\n      ? (props) => <HeaderTitle {...props} onLayout={handleTitleLayout} />\n      : (props) => title({ ...props, onLayout: handleTitleLayout });\n\n  return (\n    <Header\n      modal={modal}\n      layout={layout}\n      headerTitle={headerTitle}\n      headerLeft={headerLeft}\n      headerLeftLabelVisible={headerBackTitleVisible}\n      headerTitleContainerStyle={[titleStyle, headerTitleContainerStyle]}\n      headerLeftContainerStyle={[leftButtonStyle, headerLeftContainerStyle]}\n      headerRightContainerStyle={[rightButtonStyle, headerRightContainerStyle]}\n      headerBackgroundContainerStyle={[\n        backgroundStyle,\n        headerBackgroundContainerStyle,\n      ]}\n      headerStyle={customHeaderStyle}\n      headerStatusBarHeight={headerStatusBarHeight}\n      {...rest}\n    />\n  );\n}\n"]}